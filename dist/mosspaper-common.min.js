!function(t){"use strict";t.module("mosspaperCommon.config",[]).value("mosspaperCommon.config",{debug:!0}),t.module("mosspaperCommon.directives",[]),t.module("mosspaperCommon.filters",[]),t.module("mosspaperCommon.services",[]),t.module("mosspaperCommon.constants",[]),t.module("mosspaperCommon.events",[]),t.module("mosspaperCommon",["mosspaperCommon.config","mosspaperCommon.events","mosspaperCommon.constants","mosspaperCommon.directives","mosspaperCommon.filters","mosspaperCommon.services","ngResource","ngCookies","ngSanitize"])}(angular),angular.module("mosspaperCommon.constants",[]).value("APPLE_APP_ID","1021413203").value("GOOGLE_APP_ID","com.mosspaper.mobile3").value("STATUS_DRAFT","S").value("STATUS_APPROVED","A").value("STATUS_ACTIVE","AC").value("STATUS_PENDING","P").value("STATUS_EXPIRING","PE").value("STATUS_EXPIRED","E").value("STATUS_REJECTED","R").value("STATUS_INACTIVE","I"),angular.module("mosspaperCommon.filters",[]).filter("ago",function(){return function(t){var e=moment(t);return e.isValid()?e.fromNow():t}}).filter("percentage",["$filter",function(t){return function(e,n){return t("number")(e,n)+"%"}}]).filter("capitalize",function(){return function(t,e){return t?(t=t.toLowerCase(),t.substring(0,1).toUpperCase()+t.substring(1)):t}}).filter("propertiesFilter",["Utils",function(t){var e=function(e,n){var r=[];return angular.isArray(e)&&!t.isObjectValuesEmpty(n)?e.forEach(function(t){for(var e=!1,o=Object.keys(n),s=0;s<o.length;s++){var i=o[s];if(n[i]){var u=n[i].toLowerCase();if(t[i]&&-1!==t[i].toString().toLowerCase().indexOf(u)){e=!0;break}}}e&&r.push(t)}):r=e,r};return e}]),angular.module("mosspaperCommon.events",[]).constant("UPDATE_NOTIFICATIONS_EVENT","notifications.update"),angular.module("mosspaperCommon.services",[]).factory("Utils",["$q",function(t){return{isImage:function(e){var n=t.defer(),r=new Image;return r.onerror=function(){n.resolve(!1)},r.onload=function(){n.resolve(!0)},r.src=e,n.promise},isImageExt:function(t){return null!==t.match(/\.(jpg|jpeg|png|gif)$/)},isEmpty:function(t){if(null===t)return!0;if(t.length>0)return!1;if(0===t.length)return!0;for(var e in t)if(hasOwnProperty.call(t,e))return!1;return!0},isObjectValuesEmpty:function(t){for(var e in t)if(void 0===t[e]||""===t[e])return!0;return!1},getIndexOf:function(t,e,n){if(t){var r=t.length,o=0;for(o=0;r>o;o+=1)if(t[o][n]===e)return o}return!1},getIndexOfMultiArray:function(t,e,n){if(t){var r=t.length,o=0;for(o=0;r>o;o+=1)if(t[o][n]===e)return o}return!1},contains:function(t,e){for(var n=t.length;n--;)if(t[n]===e)return!0;return!1},containsByProperty:function(t,e,n){for(var r=t.length;r--;)if(t[r][n]===e)return!0;return!1},mergeByProperty:function(t,e,n){if(t&&e){for(var r=t.concat(e),o=0;o<r.length;++o)for(var s=o+1;s<r.length;++s)r[o][n]===r[s][n]&&r.splice(s--,1);return r}return t},updateByProperty:function(t,e,n){if(!t)return!1;for(var r=t.length-1;r>=0;r--)if(t[r][n]===e[n])return t[r]=e,!1},remove:function(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)},removeByProperty:function(t,e,n){if(t)for(var r=t.length-1;r>=0;r--)t[r][n]===e[n]&&t.splice(r,1)},removeByPropertyFromMultiArray:function(t,e,n){if(t){var r=e.name.charAt(0).toUpperCase(),o=t[r];if(o)for(var s=o.length-1;s>=0;s--)o[s][n]===e[n]&&o.splice(s,1)}},getFileName:function(t){return t.substr(t.lastIndexOf("/")+1)},getQueryParameters:function(t){return t.replace(/(^\?)/,"").split("&").map(function(t){return t=t.split("="),this[t[0]]=t[1],this}.bind({}))[0]},isBase64:function(t){var e=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$");return e.test(t)},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})}}}]),angular.module("mosspaperCommon.services").service("contractsAPIService",["$http","API_SERVER",function(t,e){var n=e+"contracts";this.getURLBase=function(){return n},this.getQuotes=function(e){return t.get(this.getURLBase()+"/",{params:e})},this.getQuoteDetails=function(e,n){var r="";return n&&(r="?action="+n),t.get(this.getURLBase()+"/"+e+r+"/")},this.getQuoteDS=function(e){return t.get(this.getURLBase()+"/signature/"+e+"/")},this.getQuoteHistory=function(e){return t.get(this.getURLBase()+"/history/"+e+"/")},this.exitQuoteDetails=function(e,n){return t.put(this.getURLBase()+"/exit/"+e+"?action="+n)},this.insertQuote=function(e){return t.post(this.getURLBase()+"/",e)},this.updateQuote=function(e,n){return t.put(this.getURLBase()+"/"+e+"/",n)},this.resendQuote=function(e){return t.post(this.getURLBase()+"/resend/"+e+"/")},this.saveQuote=function(e){return t.put(this.getURLBase()+"/save/"+e+"/")},this.confirmQuote=function(e){return t.put(this.getURLBase()+"/confirm/"+e+"/")},this.getComments=function(e){return t.get(this.getURLBase()+"/comment/"+e+"/")},this.addQuoteComment=function(e,n){return t.post(this.getURLBase()+"/comment/"+e+"/",n)},this.deleteComment=function(e,n){return t.post(this.getURLBase()+"/comment/delete/"+e+"/",n)},this.deleteQuote=function(e){return t["delete"](this.getURLBase()+"/"+e+"/")},this.approveQuote=function(e,n){return t.post(this.getURLBase()+"/approve/"+e+"/",n)},this.deleteDocument=function(e){return t["delete"](this.getURLBase()+"/document/"+e+"/")},this.requestPayment=function(e,n){return t.post(this.getURLBase()+"/payment/"+e+"/",n)},this.recordPayment=function(e,r){return t.post(n+"/payment/record/"+e+"/",r)},this.getQuoteRequests=function(e){return t.get(this.getURLBase()+"/requests",{params:e})},this.cloneContract=function(e){return t.post(n+"/clone/"+e+"/")},this.getPayment=function(e){return t.get(n+"/payment/"+e+"/")},this.terminate=function(e){return t.post(n+"/terminate/"+e+"/")},this.getEmailPreview=function(e){return t.get(this.getURLBase()+"/email/preview/"+e+"/")},this.getEndingContracts=function(e){return t.get(this.getURLBase()+"/ending",{params:e})},this.getContractCount=function(e){return t.get(this.getURLBase()+"/count/added/",{params:e})},this.getContractCountByTimeframe=function(e){return t.get(this.getURLBase()+"/count/",{params:e})},this.getApprovalRating=function(){return t.get(this.getURLBase()+"/approval/percentage")},this.getStatusCount=function(e){return t.get(this.getURLBase()+"/status/count/",{params:e})},this.getAvgAmt=function(){return t.get(this.getURLBase()+"/stats/average/")},this.getExpiringContracts=function(e){return t.get(this.getURLBase()+"/expiring",{params:e})}}]),angular.module("mosspaperCommon.services").service("itemsAPIService",["$http","API_SERVER",function(t,e){var n=e+"products";this.getCategories=function(){return t.get(n+"/category/")},this.insertCategory=function(e){return t.post(n+"/category/",e)},this.updateCategory=function(e,r){return t.put(n+"/category/"+e+"/",r)},this.deleteCategory=function(e){return t["delete"](n+"/category/"+e+"/")},this.insertProduct=function(e){return t.post(n+"/",e)},this.updateProduct=function(e,r){return t.put(n+"/"+e+"/",r)},this.deleteProduct=function(e){return t["delete"](n+"/"+e+"/")},this.deleteProducts=function(e){return t.post(n+"/delete/",e)},this.getProducts=function(e){return t.get(n+"/",{params:e})},this.getProduct=function(e){return t.get(n+"/"+e+"/")},this.getProductsCount=function(){return t.get(n+"/?count=true")},this.getProductsByType=function(e){return t.get(n+"/type/?type="+e)},this.getProductTypeCount=function(){return t.get(n+"/type/?count=true")},this.exportCSV=function(){return t.get(n+"/csv")},this.saveMappedProductCSV=function(e){return t.put(n+"/csv/",e)},this.getTopItems=function(e){return t.get(n+"/top",{params:e})}}]),angular.module("mosspaperCommon.services").service("quoteAPIService",["$http","API_SERVER",function(t,e){var n=e+"quotes";this.getURLBase=function(){return n},this.getQuotes=function(e){return t.get(this.getURLBase()+"/",{params:e})},this.getQuoteDetails=function(e,n){var r="";return n&&(r="?action="+n),t.get(this.getURLBase()+"/"+e+r+"/")},this.getQuoteDS=function(e){return t.get(this.getURLBase()+"/signature/"+e+"/")},this.getQuoteHistory=function(e){return t.get(this.getURLBase()+"/history/"+e+"/")},this.exitQuoteDetails=function(e,n){return t.put(this.getURLBase()+"/exit/"+e+"?action="+n)},this.insertQuote=function(e){return t.post(this.getURLBase()+"/",e)},this.updateQuote=function(e,n){return t.put(this.getURLBase()+"/"+e+"/",n)},this.resendQuote=function(e){return t.post(this.getURLBase()+"/resend/"+e+"/")},this.saveQuote=function(e){return t.put(this.getURLBase()+"/save/"+e+"/")},this.confirmQuote=function(e){return t.put(this.getURLBase()+"/confirm/"+e+"/")},this.getComments=function(e){return t.get(this.getURLBase()+"/comment/"+e+"/")},this.addQuoteComment=function(e,n){return t.post(this.getURLBase()+"/comment/"+e+"/",n)},this.deleteComment=function(e,n){return t.post(this.getURLBase()+"/comment/delete/"+e+"/",n)},this.deleteQuote=function(e){return t["delete"](this.getURLBase()+"/"+e+"/")},this.approveQuote=function(e,n){return t.post(this.getURLBase()+"/approve/"+e+"/",n)},this.getEmailPreview=function(e){return t.get(this.getURLBase()+"/email/preview/"+e+"/")},this.deleteDocument=function(e){return t["delete"](this.getURLBase()+"/document/"+e+"/")},this.getPayment=function(e){return t.get(this.getURLBase()+"/payment/"+e+"/")},this.requestPayment=function(e,n){return t.post(this.getURLBase()+"/payment/"+e+"/",n)},this.recordPayment=function(e,n){return t.post(this.getURLBase()+"/payment/record/"+e+"/",n)},this.deletePayment=function(e,r){return t["delete"](n+"/payment/"+e+"/",{params:r})},this.getQuoteCountByTimeframe=function(e){return t.get(this.getURLBase()+"/count/",{params:e})},this.getQuoteCount=function(e){return t.get(this.getURLBase()+"/count/added/",{params:e})},this.getApprovalRating=function(){return t.get(this.getURLBase()+"/approval/percentage")},this.getStatusCount=function(e){return t.get(this.getURLBase()+"/status/count/",{params:e})},this.getAvgAmt=function(){return t.get(this.getURLBase()+"/stats/average/")},this.getQuoteRequests=function(e){return t.get(this.getURLBase()+"/requests/",{params:e})},this.getQuoteRequest=function(e){return t.get(this.getURLBase()+"/requests/"+e+"/")},this.getQuoteRequestCount=function(){return t.get(this.getURLBase()+"/requests/count/")},this.deleteQuoteRequest=function(e){return t.post(this.getURLBase()+"/requests/delete/",e)}}]),angular.module("mosspaperCommon.services").factory("itemsManager",["$http","$q","itemsAPIService",function(t,e,n){var r={_pool:{},_retrieveInstance:function(t,e){var n=this._pool[t];return n?n.setData(e):this._pool[t]=n,n},_search:function(t){return this._pool[t]},_load:function(t,e){var r=this;n.getProduct(t).success(function(t){var n=r._retrieveInstance(t.id,t);e.resolve(n)}).error(function(){e.reject()})},getItem:function(t){var n=e.defer(),r=this._search(t);return r?n.resolve(r):this._load(t,n),n.promise},fetchAll:function(){var t=e.defer(),r=this,o={};return n.getProducts(o).success(function(e){var n=[];e.forEach(function(t){var e=r._retrieveInstance(t.id,t);n.push(e)}),t.resolve(n)}).error(function(){t.reject()}),t.promise},setBook:function(t){var e=this,n=this._search(t.id);return n?n.setData(t):n=e._retrieveInstance(t),n}};return r}]),angular.module("mosspaperCommon.services").service("notificationAPIService",["$http","API_SERVER",function(t,e){var n=e+"user/notification/";this.getNotifcations=function(){return t.get(n)},this.getNotifcationCount=function(){return t.get(n+"?count=true")},this.deleteNotifiction=function(e){return t["delete"](n+"delete/"+e+"/")}}]),angular.module("mosspaperCommon.services").factory("NotificationFactory",["$http","$rootScope","$q","notificationAPIService","UPDATE_NOTIFICATIONS_EVENT","Utils",function(t,e,n,r,o,s){this._items=[];var i=function(){e.$emit(o,this._items)},u={fetchAll:function(t){var e=n.defer();return this._items?(console.log("get from cache"),e.resolve(this._items)):r.getNotifcations().success(function(t){e.resolve(t),this._items=t,i()}).error(function(){e.reject()}),e.promise},getNotifications:function(){return _items},deleteNotification:function(t){var e=n.defer();return r.deleteNotifiction(t.id).success(function(){s.removeByProperty(this._items,t,"id"),e.resolve(),i()}).error(function(){e.reject()}),e.promise},deleteAll:function(){var t=n.defer();return r.deleteNotifiction("all").success(function(e){t.resolve(e),this._items=[],i()}).error(function(){t.reject()}),t.promise}};return u}]);